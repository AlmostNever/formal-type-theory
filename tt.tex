\section{Type theory}
\label{sec:type-theory}

In this section we give the formulation of type theory that we shall work with.

\subsection{Syntax}
\label{sec:syntax}

\begin{align*}
  \text{Context $\G$, $\D$}
    \bnf   {}& \ctxempty                && \text{empty context} \\
    \bnfor {}& \ctxextend{\G}{\A}       && \text{context $\G$ extended with $\A$} \\
  \\
  \text{Type $\A$, $\B$, $\C$}
    \bnf   {}& \Prod{\A} \B             && \text{product}\\
    \bnfor {}& \Id{\A}{\uu}{\vv}        && \text{identity type} \\
    \bnfor {}& \subst{\A}{\sbs}         && \text{substitution $\sbs$ applied to $\A$} \\
  \\
  \text{Term $\uu$, $\vv$, $\ww$}
    \bnf   {}& \var{k}                  && \text{the $k$-th variable index (a la de Bruijn)} \\
    \bnfor {}& \lam{\A}{\B} \uu         && \text{$\lambda$-abstraction} \\
    \bnfor {}& \app{\uu}{\A}{\B}{\vv}   && \text{application} \\
    \bnfor {}& \refl{\A} \uu            && \text{reflexivity} \\
    \bnfor {}& \subst{\uu}{\sbs}        && \text{substitution $\sbs$ applied to $\uu$} \\
  \\
  \text{Substitution $\sbs$, $\sbt$}
    \bnfor {}& \sbzero{\G}{\A}{\uu}     && \text{substitute $u$ for the $0$-th index} \\
    \bnfor {}& \sbweak{\G}{\A}          && \text{weakening substitution $\ctxextend{\G}{\A} \to \G$} \\
    \bnfor {}& \sbshift{\G}{\A}{\sbs}   && \text{shift substitution}
\end{align*}

\subsection{Judgments}
\label{sec:judgments}

\begin{align*}
& \isctx{\G}                    && \text{$\G$ is a context} \\
& \issubst{\sbs}{\G}{\D}        && \text{$\sbs$ is a substitution from context $\G$ to context $\D$} \\
& \istype{\G}{\A}               && \text{$\A$ is a type in context $\G$} \\
& \isterm{\G}{\uu}{\A}          && \text{$\uu$ is a term of type $\A$ in context $\G$} \\
& \eqctx{\G}{\D}                && \text{$\G$ and $\D$ are equal contexts} \\
& \eqtype{\G}{\A}{\B}           && \text{$\A$ and $\B$ are equal types in context $\G$} \\
& \eqterm{\G}{\uu}{\vv}{\A}     && \text{$\uu$ and $\vv$ are equal terms of type $\A$ in context $\G$}
\end{align*}

\subsection{Contexts \fbox{$\isctx{\G}$}}
\label{sec:contexts}

\begin{mathpar}
  {\label{rul:ctx-empty} \showCtxEmpty}

  {\label{rul:ctx-extend} \showCtxExtend}
\end{mathpar}

\subsection{Substitutions \fbox{$\issubst{\sbs}{\G}{\D}$}}
\label{sec:subst}

\begin{mathpar}
  {\label{rul:subst-zero} \showSubstZero}

  {\label{rul:subst-weak} \showSubstWeak}

 {\label{rul:subst-shift} \showSubstShift}
\end{mathpar}

\subsection{Types \fbox{$\istype{\G}{\A}$}}

\subsubsection*{General rules}

\begin{mathpar}
  {\label{rul:ty-ctx-conv} \showTyCtxConv}

  {\label{rul:ty-subst} \showTySubst}
\end{mathpar}

\subsubsection*{Type formers}

\begin{mathpar}
  {\label{rul:ty-prod} \showTyProd}

  {\label{rul:ty-id} \showTyId}
\end{mathpar}

\subsection{Terms \fbox{$\isterm{\G}{\uu}{\A}$}}

\subsubsection*{General rules}
\begin{mathpar}
  {\label{rul:term-ty-conv} \showTermTyConv}

  {\label{rul:term-ctx-conv} \showTermCtxConv}

  {\label{rul:term-subst} \showTermSubst}
\end{mathpar}

\subsubsection*{Variables}

\begin{mathpar}
  {\label{rul:term-var} \showTermVar}

  {\label{rul:term-var-skip} \showTermVarSkip}
  \end{mathpar}

\subsubsection*{Abstraction and application}

\begin{mathpar}
  % Remark: we want \istype{\G}{\A} as a premise because in order to form the
  % product type we need it, and we do not want to resort to inversion on the
  % extended context.
  {\label{rul:term-abs} \showTermAbs}

  % Remark: we want \istype{\ctxextend{\G}{\A}}{\B} because we need to
  % know that \B is a type in \ctxextend{\G}{\A} and we want to avoid
  % inversion on ty-prod.
  {\label{rul:term-app} \showTermApp}
\end{mathpar}


\subsubsection*{Reflexivity}

\begin{mathpar}
  {\label{rul:term-refl} \showTermRefl}
\end{mathpar}

\subsection{Context equality \fbox{$\eqctx{\G}{\D}$}}
\label{sec:cont-equal}

\begin{mathpar}
  {\label{rul:eq-ctx-empty} \showEqCtxEmpty}

  {\label{rul:eq-ctx-extend} \showEqCtxExtend}
\end{mathpar}

\goodbreak

\subsection{Type equality \fbox{$\eqtype{\G}{\A}{\B}$}}
\label{sec:type-equality}

\subsubsection*{General rules}

\begin{mathpar}
  {\label{rul:eq-ty-ctx-conv} \showEqTyCtxConv}

  {\label{rul:eq-ty-refl} \showEqTyRefl}

  {\label{rul:eq-ty-sym} \showEqTySym}

  {\label{rul:eq-ty-trans} \showEqTyTrans}
\end{mathpar}

\subsubsection*{Substitution}

\begin{mathpar}
  {\label{rul:eq-ty-weak-nat} \showEqTyWeakNat}

  {\label{rul:eq-ty-subst-prod} \showEqTySubstProd}

  {\label{rul:eq-ty-subst-id} \showEqTySubstId}
\end{mathpar}

\subsubsection*{Congruence rules}

\begin{mathpar}
  {\label{rul:cong-prod} \showCongProd}

  {\label{rul:cong-id} \showCongId}

  {\label{rul:cong-ty-subst} \showCongTySubst}
\end{mathpar}

\goodbreak

\subsection{Term equality \fbox{$\eqterm{\G}{\uu_1}{\uu_2}{\A}$}}

\subsubsection*{General rules}

\begin{mathpar}
  {\label{rul:eq-ty-conv} \showEqTyConv}

  {\label{rul:eq-ctx-conv} \showEqCtxConv}

  {\label{rul:eq-refl} \showEqRefl}

  {\label{rul:eq-sym} \showEqSym}

  {\label{rul:eq-trans} \showEqTrans}
\end{mathpar}

\subsubsection*{Substitutions}

\begin{mathpar}
  {\label{rul:eq-subst-weak} \showEqSubstWeak}

  {\label{rul:eq-subst-zero-zero} \showEqSubstZeroZero}

  {\label{rul:eq-subst-zero-succ} \showEqSubstZeroSucc}

  {\label{rul:eq-subst-shift-zero} \showEqSubstShiftZero}

  {\label{rul:eq-subst-shift-succ} \showEqSubstShiftSucc}

  {\label{rul:eq-subst-abs} \showEqSubstAbs}

  {\label{rul:eq-subst-app} \showEqSubstApp}

  {\label{rul:eq-subst-refl} \showEqSubstRefl}
\end{mathpar}

\subsubsection*{Equality reflection}
%
\begin{mathpar}
  {\label{rul:eq-reflection} \showEqReflection}
\end{mathpar}
%
Here $\mathsf{UIP}(\A)$ is an abbreviation for what is written traditionally as
``all parallel paths in $\A$ are (propositionally) equal''.

\subsubsection*{Computation and Extensionality}

\begin{mathpar}
  {\label{rul:prod-beta} \showProdBeta}

  {\label{rul:prod-eta} \showProdEta}
\end{mathpar}

The rule {\rlProdEta} is optional. We may prefer not to keep it around, as it amounts
to function extensionality.

\subsubsection*{Congruence rules}

\begin{mathpar}
  {\label{rul:cong-abs} \showCongAbs}

  {\label{rul:cong-app} \showCongApp}

  {\label{rul:cong-refl} \showCongRefl}

  {\label{rul:cong-term-subst} \showCongTermSubst}
\end{mathpar}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
